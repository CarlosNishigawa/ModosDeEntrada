<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Desafio dos Modos de Entrada</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0f172a; color:#f8fafc; margin:0; }
    .container{max-width:900px;margin:0 auto;padding:20px}
    h1{text-align:center;margin-bottom:20px}
    #qrcode {margin:20px auto;display:flex;justify-content:center}
    iframe {width:100%;height:80vh;border:none;border-radius:12px;margin-top:20px}
    .btn{background:#3b82f6;color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:bold}
    .btn:hover{background:#2563eb}
    .center{text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <h1>Desafio dos Modos de Entrada</h1>
    <p class="center">Escaneie o QR Code abaixo para jogar no seu celular:</p>
    <div id="qrcode"></div>
    <div class="center"><button class="btn" onclick="window.open(gameUrl,'_blank')">Abrir em nova aba</button></div>
    <iframe id="gameFrame"></iframe>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <script>
    // URL do jogo (pode ser publicado no GitHub Pages, Netlify etc.)
    const gameUrl = window.location.href; // aqui ele gera o QR para a pr√≥pria p√°gina

    // Gera QR Code
    const qr = new QRious({
      element: document.createElement('canvas'),
      value: gameUrl,
      size: 250,
      background: 'white',
      foreground: 'black'
    });
    document.getElementById('qrcode').appendChild(q.canvas);

    // Carrega o jogo no iframe (aqui poderia embutir o HTML do jogo real)
    document.getElementById('gameFrame').src = gameUrl + "?play=1";
  </script>
  
  <!-- Bot√£o flutuante para mostrar QR no projetor -->
  <button id="qrFloatBtn" style="position:fixed;right:18px;bottom:18px;background:linear-gradient(135deg,#3b82f6,#22d3ee);border:none;color:#001026;padding:12px 14px;border-radius:12px;font-weight:800;cursor:pointer;z-index:9999;box-shadow:0 10px 24px rgba(0,0,0,.25)">üì± Mostrar QR</button>

  <!-- Modal simples de QR -->
  <div id="qrModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(4px);z-index:9998;">
    <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:20px;">
      <div style="background:#0b1227;border:1px solid rgba(255,255,255,.15);border-radius:16px;padding:18px;max-width:92vw;text-align:center">
        <div style="font-weight:800;margin-bottom:8px">Escaneie para jogar no seu celular</div>
        <img id="qrImgPlay" alt="QR code do jogo" style="max-width:70vw;max-height:70vh;background:#fff;padding:10px;border-radius:12px"/>
        <div id="qrLinkPlay" style="margin-top:8px;color:#a3a3a3;word-break:break-all;font-size:12px"></div>
        <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
          <button id="copyPlayLink" class="btn" style="background:linear-gradient(135deg,#3b82f6,#22d3ee);border:none;color:#001026;padding:8px 12px;border-radius:10px;font-weight:800;cursor:pointer">Copiar link</button>
          <button id="closeQR" class="btn secondary" style="background:transparent;border:1px solid rgba(255,255,255,.25);color:#fff;padding:8px 12px;border-radius:10px;cursor:pointer">Fechar</button>
        </div>
        <div style="margin-top:8px;color:#a3a3a3;font-size:12px">Dica: abra este arquivo hospedado (GitHub Pages/Netlify) para a turma acessar via internet.</div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const btn = document.getElementById('qrFloatBtn');
      const modal = document.getElementById('qrModal');
      const img = document.getElementById('qrImgPlay');
      const link = document.getElementById('qrLinkPlay');
      const closeBtn = document.getElementById('closeQR');
      const copyBtn = document.getElementById('copyPlayLink');

      function currentUrl(){
        // Se estiver rodando local (file://), tente usar o endere√ßo LAN se dispon√≠vel via prompt
        let url = window.location.href;
        try {
          const hinted = sessionStorage.getItem('hosted_url_hint');
          if(hinted) url = hinted;
        } catch(e){}
        return url;
      }

      function setQR(){
        const url = currentUrl();
        const api = 'https://chart.googleapis.com/chart?cht=qr&chs=600x600&chl=' + encodeURIComponent(url);
        if(img) img.src = api;
        if(link) link.textContent = url;
      }

      function show(){
        setQR();
        if(modal) modal.style.display = 'block';
      }
      function hide(){ if(modal) modal.style.display = 'none'; }

      function copy(text){
        if(navigator.clipboard && window.isSecureContext){ navigator.clipboard.writeText(text); }
        else {
          const ta = document.createElement('textarea'); ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
        }
      }

      if(btn) btn.addEventListener('click', show);
      if(closeBtn) closeBtn.addEventListener('click', hide);
      if(modal) modal.addEventListener('click', (e)=>{ if(e.target===modal) hide(); });
      if(copyBtn) copyBtn.addEventListener('click', ()=> copy(currentUrl()));

      // Atalho: pressione "Q" para abrir/fechar o QR no projetor
      window.addEventListener('keydown', (e)=>{ if(e.key.toLowerCase()==='q'){ if(modal.style.display==='block') hide(); else show(); }});

      // Se o professor quiser for√ßar um URL (ex.: da hospedagem), use no console:
      // sessionStorage.setItem('hosted_url_hint', 'https://seu-dominio.exemplo/jogo');
    })();
  </script>
</body>
</html>
